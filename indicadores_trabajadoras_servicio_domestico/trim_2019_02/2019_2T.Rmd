---
title: "Indicadores sobre Trabajadoras de Servicio Doméstico"
subtitle: "Datos de la Encuesta Permanente de Hogares. 2do trimestre de 2019."
author: "Natsumi Shokida para Economía Femini(s)ta"
date: "Marzo de 2020"
output: 
  html_notebook:
    toc: yes
    toc_float: yes
    toc_depth: 3
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Se cargan librerías útiles
library(tidyverse)
library(httr)
library(stringr)
library(openxlsx)
library(haven)
library(readxl)
library(ggthemes)
library(scales)
library(knitr)
library(ggalt)
library(kableExtra)
library(formattable)
library(questionr)
library(eph)
# Como fuente tomamos un script con el código que permite construir las ramas de la ocupación de acuerdo al nomenclador
source("../../R/funciones rama.R") 
source("../../R/funciones formato.R")
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
date <- "2do trimestre de 2019"                        # <-----------------
```

Aquí se presentan diversos indicadores referidos a las condiciones de trabajo de las trabajadoras que prestan servicio doméstico en hogares particulares. La información proviene de la base usuaria de la Encuesta Permanente de Hogares (EPH-INDEC-Argentina) y refiere a los 31 aglomerados urbanos relevados por la misma durante el `r date`.     
El presente documento no consiste en un informe o publicación finalizada, sino en la disponibilización de resultados parciales de un trabajo más amplio.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Cargo base de EPH con el paquete eph
base_individual <- eph::get_microdata(year = 2019, trimester = 2, type =  "individual") 
base_hogar <- eph::get_microdata(year = 2019, trimester = 2, type =  "hogar") 
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Modificaciones en la base
base_individual <- base_individual %>% 
  mutate(Sexo = as.character(CH04),
         Sexo = case_when(Sexo=="1" ~ "Varones",
                          Sexo=="2" ~ "Mujeres"),
         NIVEL_EDUCATIVO = case_when(NIVEL_ED %in% c(1, 7) ~ "Sin Instrucción",
                                     NIVEL_ED %in% c(2, 3) ~ "Primaria",
                                     NIVEL_ED %in% c(4, 5) ~ "Secundaria",
                                     NIVEL_ED == 6         ~ "Superior",
                                     NIVEL_ED == 9         ~ "NS/NR"),
         NIVEL_EDUCATIVO = factor(NIVEL_EDUCATIVO, levels = c("Sin Instrucción", "Primaria", "Secundaria", "Superior")),
         GRUPO_EDAD = case_when(CH06 >= 14 & CH06 <= 29 ~ "de 14 a 29 años",
                                CH06 >= 30 & CH06 <= 49 ~ "de 30 a 49 años",
                                CH06 >= 50 & CH06 <= 64 ~ "de 50 a 64 años",
                                CH06 >= 65              ~ "65 años y más"),
         GRUPO_EDAD = factor(GRUPO_EDAD, 
                             levels = c("de 14 a 29 años",
                                        "de 30 a 49 años",
                                        "de 50 a 64 años",
                                        "65 años y más")),
         DONDE_NACIO = case_when(CH15 == 1 ~ "En esta localidad",
                                 CH15 == 2 ~ "En otra localidad de esta provincia",
                                 CH15 == 3 ~ "En otra provincia",
                                 CH15 == 4 ~ "En un país limítrofe",
                                 CH15 == 5 ~ "En otro país",
                                 CH15 == 9 ~ "NS/NR"),
         DONDE_NACIO = factor(DONDE_NACIO,
                              levels = c("En esta localidad",
                                         "En otra localidad de esta provincia",
                                         "En otra provincia",
                                         "En un país limítrofe",
                                         "En otro país",
                                         "NS/NR")),
         Vacaciones_pagas = case_when(PP07G1 == 1 ~ "Sí",
                                      PP07G1 == 2 ~ "No"),
         Aguinaldo = case_when(PP07G2 == 1 ~ "Sí",
                               PP07G2 == 2 ~ "No"),
         Dias_enfermedad = case_when(PP07G3 == 1 ~ "Sí",
                                     PP07G3 == 2 ~ "No"),
         Obra_social = case_when(PP07G4 == 1 ~ "Sí",
                                 PP07G4 == 2 ~ "No"),
         Descuento_jubilatorio = case_when(PP07H == 1 ~ "Sí",
                                           PP07H == 2 ~ "No"))

# colores = c("#aa165a","#16aa66")
colores = c("#FE1764", "#00BDD6")
```

### Trabajadoras del Servicio doméstico

Si bien analizamos al conjunto de les trabajadores de se dedican a esta actividad, utilizamos pronombres femeninos a la hora de generalizar, dada la alta tasa de feminidad del sector. A su vez, cabe destacar que se realiza el ejercicio en términos cis-binarios por falta de información respecto de las identidades trans-travesti en las estadísticas oficiales.     
Más de 900 mil personas componen al sector, siendo el equivalente a 13 canchas de River llenas. Se trata de una cantidad estimada para las grandes ciudades del país (31 aglomerados urbanos relevados por la encuesta).      
La tasa de feminidad del sector es del 97,9%. Es decir, que casi en su totalidad se trata de trabajadoras mujeres.   
A su vez, las trabajadoras que realizan tareas domésticas y de cuidado en hogares particulares, representan un 17% dentro del total de ocupadas mujeres. Esto significa que una de cada 6 ocupadas en Argentina trabaja en este sector de la economía.   
La leve diferencia en la cantidad se debe a que, en este último caso, sólo estamos considerando a las mujeres del sector.    
Al mismo tiempo, estas más de 900.000 trabajadoras representan un 22% dentro del total de ocupadas-asalariadas. O sea que dentro de las mujeres que trabajan en relación de dependencia, 1 de cada 5 tiene como ocupación principal el trabajo en hogares particulares. 

```{r message=FALSE, warning=FALSE, include=FALSE}
# Armamos una mini base de servicio doméstico utilizando la pregunta PP04B1, que identifica a las personas que prestan servicio doméstico en hogares particulares. 

serv.dom <- base_individual %>% 
  filter(PP04B1 == 1)
# Contamos con 1899 casos muestrales
# Luego, a la hora de trabajar con el clasificador de actividades, se encuentran más casos en "Actividades de los hogares como empleadores de personal doméstico", pero se verá que se trata de casos que no respondieron en cuántas casas trabajan.

table(serv.dom$ESTADO, serv.dom$CAT_OCUP, exclude = NULL)
# Todas ocupadas - asalariadas. 
```

<p style="color:#FE1764">__Cantidad de personas que se dedican al servicio doméstico__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% summarise(Cantidad = formato_cantidad(sum(PONDERA))) %>% 
  kable(align = "c",  col.names = NULL) %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T, font_size = 50)  
    # row_spec(0, bold = T, color = "white", background = "#FE1764")
```

<p style="color:#FE1764">__Proporcion de mujeres y de varones__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% 
  mutate(Total = sum(PONDERA)) %>% 
  group_by(Sexo) %>% 
  summarise(Porcentaje = formato_porc(sum(PONDERA)/unique(Total)*100)) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

<p style="color:#FE1764">__Proporción de servicio doméstico dentro de las ocupadas mujeres__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
base_individual %>% 
  filter(ESTADO == 1,
         Sexo == "Mujeres") %>% 
  mutate(Servicio_domestico = case_when(PP04B1 == 1 ~ "Sí",
                                        PP04B1 != 1 ~ "No")) %>% 
  group_by(Servicio_domestico) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select("¿Se dedica al servicio doméstico?" = Servicio_domestico,
         Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

<p style="color:#FE1764">__Proporción de servicio doméstico dentro de las asalariadas mujeres__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
base_individual %>% 
  filter(ESTADO == 1,
         CAT_OCUP == 3,
         Sexo == "Mujeres") %>% 
  mutate(Servicio_domestico = case_when(PP04B1 == 1 ~ "Sí",
                                        PP04B1 != 1 ~ "No")) %>% 
  group_by(Servicio_domestico) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select("¿Se dedica al servicio doméstico?" = Servicio_domestico,
         Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

### Características

#### Edad
        
Mientras que casi la mitad de estas trabajadoras tienen entre 30 y 49 años, un 31% tiene entre 50 y 64 años. Por su parte, hay un 5,4% que continúa trabajando a pesar de haber superado la edad jubilatoria, y un 16.6% son jóvenes que tienen hasta 29 años. Este último grupo está compuesto por más de 150 mil jóvenes.
        
<p style="color:#FE1764">__Composicion por edad de las trabajadoras del servicio doméstico__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% 
  group_by(GRUPO_EDAD) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>%
  select(Edad = GRUPO_EDAD, Cantidad, Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

#### Lugar de nacimiento

<p style="color:#FE1764">__Lugar de nacimiento de las trabajadoras de servicio doméstico y del total de la población__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Tabla intermedia. Casos de servicio doméstico. Chequeo cantidades muestrales.
tabla1 <- serv.dom %>% 
  group_by(DONDE_NACIO) %>% 
  summarise(n=n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  select(DONDE_NACIO, Cantidad, Porcentaje)

# Tabla intermedia. Todos los casos. Chequeo cantidades muestrales.
tabla2 <- base_individual %>% 
  group_by(DONDE_NACIO) %>% 
  summarise(n=n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  select(DONDE_NACIO, Cantidad, Porcentaje)

left_join(tabla1, tabla2, by = "DONDE_NACIO") %>% 
  filter(DONDE_NACIO != "En otro país",
         DONDE_NACIO != "NS/NR") %>% 
  select("¿Dónde nació?" = DONDE_NACIO,
         "Cantidad" = Cantidad.x,
         "Porcentaje" = Porcentaje.x,
         "Cantidad" = Cantidad.y,
         "Porcentaje" = Porcentaje.y) %>% 
  kable(align = "r") %>% 
  add_header_above(c("      " = 1, "Trabajadoras de Servicio Doméstico" = 2, "Población general" = 2), 
                   bold = T, color = "white", background = "#FE1764") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

_Nota: Las estimaciones correspondientes a aquellas personas que han nacido en otro país (no limítrofe) y aquellas que NS/NR la pregunta, no cuentan con suficientes casos muestrales como para garantizar significatividad del dato, por lo que se ha retirado del cuadro las categorías._     

```{r message=FALSE, warning=FALSE, include=FALSE}
rm(tabla1, tabla2)
```

#### Educación

Más de la mitad de las trabajadoras del sector cuenta con el nivel primario de escolaridad finalizado, a lo que se suma un 35,7% que cuenta también con el nivel secundario. En tanto, un 7,7% no posee instrucción formal.     

<p style="color:#FE1764">__Composicion por nivel educativo de las trabajadoras del servicio doméstico__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% 
  group_by(NIVEL_EDUCATIVO) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>%
  filter(NIVEL_EDUCATIVO != "Superior") %>% 
  select("Nivel educativo" = NIVEL_EDUCATIVO, Cantidad, Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

_Nota: La estimación correspondiente a aquellas que han finalizado un nivel superior de formación no cuenta con suficientes casos muestrales como para garantizar significatividad del dato, por lo que se ha retirado del cuadro la categoría._       
          
<p style="color:#FE1764">__Las jóvenes y su formación educativa__</p>               
                      
En este apartado se presentan indicadores referidos a las jóvenes de entre 14 y 29 años que se desempeñan como trabajadoras domésticas, y sus características respecto de la asistencia a establecimientos educativos. En primer lugar, puede observarse que un 23,4% (casi 1 de cada 4) asiste a un establecimiento educativo al mismo tiempo que se desempeña en su trabajo. Este indicador se ubica 9 puntos por debajo de la tasa de formación en curso de aquellas ocupadas que no se dedican a esta tarea en particular, dado que un 32,4% de aquellas que no se dedican al trabajo doméstico remunerado se encuentran asistiendo a un establecimiento educativo.     
Tanto entre las que trabajan en el sector de tareas domésticas y de cuidado como entre las que no, aquellas que se encuentran estudiando lo hacen en su mayoría en un Terciario o carrera universitaria, seguidas por las que se encuentran finalizando el Secundario o el Polimodal. Sin embargo, entre estas ocupadas que estudian, la probablidad de estar cursando el nivel Terciario o Universitario es del 85,5% entre quienes no se dedican al servicio doméstico, al tiempo que esta tasa disminuye a 65,5% entre las que sí se desempeñan en dicho sector de la economía.    
            
<p style="color:#FE1764">__Mujeres jóvenes del servicio doméstico por asistencia a establecimiento educativo__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% 
  filter(Sexo == "Mujeres",
         GRUPO_EDAD == "de 14 a 29 años") %>% 
  mutate(Asistencia = case_when(CH10 == 1 ~ "Asiste actualmente",
                                CH10 == 2 ~ "No asiste, pero asistió en el pasado",
                                CH10 == 3 ~ "Nunca asistió")) %>% 
  group_by(Asistencia) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  filter(Asistencia != "Nunca asistió") %>% 
  select("¿Asiste a un establecimiento educativo?" = Asistencia,
         Cantidad, Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```
_Nota: La estimación correspondiente a aquellas que nunca asistieron a un establecimiento educativo no cuenta con suficientes casos muestrales como para garantizar significatividad del dato, por lo que se ha retirado del cuadro la categoría._         
                
<p style="color:#FE1764">__Ocupadas jóvenes según si se dedican al servicio doméstico y su respectiva tasa de asistencia a un establecimiento educativo__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
base_individual %>% 
  filter(Sexo == "Mujeres",
         GRUPO_EDAD == "de 14 a 29 años",
         ESTADO == 1) %>% 
  mutate(Asistencia = case_when(CH10 == 1 ~ "Asiste actualmente",
                                CH10 == 2 ~ "No asiste, pero asistió en el pasado",
                                CH10 == 3 ~ "Nunca asistió"),
         Servicio_domestico = case_when(PP04B1 == 1 ~ "Sí",
                                        PP04B1 != 1 ~ "No")) %>% 
  group_by(Servicio_domestico, Asistencia) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  filter(Asistencia == "Asiste actualmente") %>% 
  select("¿Se dedica al servicio doméstico?" = Servicio_domestico,
         "Tasa de asistencia a est. educativo" = Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```
_Nota: La estimación correspondiente a aquellas que nunca asistieron a un establecimiento educativo no cuenta con suficientes casos muestrales como para garantizar significatividad del dato, por lo que se ha retirado del cuadro la categoría._         
          
<p style="color:#FE1764">__Ocupadas jóvenes que estudian según si se dedican al servicio doméstico, y qué nivel se encuentran cursando__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
#ocupadas jóvenes que asisten segun si son de servicio domestico y a qué nivel
base_individual %>% 
  filter(Sexo == "Mujeres",
         GRUPO_EDAD == "de 14 a 29 años",
         ESTADO == 1,
         CH10 == 1) %>% 
  mutate(Servicio_domestico = case_when(PP04B1 == 1 ~ "Sí",
                                        PP04B1 != 1 ~ "No"),
         Nivel = case_when(CH12 == 1 ~ "Jardín/Preescolar",
                           CH12 %in% c(2, 3) ~ "Primario/EGB",
                           CH12 %in% c(4, 5) ~ "Secundario/Polimodal",
                           CH12 %in% c(6, 7) ~ "Terciario/Universitario",
                           CH12 == 8 ~ "Posgrado",
                           CH12 == 9 ~ "Ed. Especial")) %>% 
  group_by(Servicio_domestico, Nivel) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  filter(Nivel %in% c("Secundario/Polimodal", "Terciario/Universitario")) %>% 
  select("¿Se dedica al servicio doméstico?" = Servicio_domestico,
         "Nivel al que asiste" = Nivel,
         "Tasa" = Porcentaje) %>% 
  spread(., "Nivel al que asiste", Tasa) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```
_Nota: Las estimaciones correspondientes a otros niveles educativos en curso no cuentan con suficientes casos muestrales como para garantizar significatividad de los datos, por lo que se las ha retirado del cuadro._ 

### Intensidad del trabajo

En esta sección no se filtra a las mujeres, pero al igual que en todo el ejercicio, hacemos uso del femenino por la alta tasa de feminidad del sector.                 

Un 71,2% de las empleadas domésticas es contratada por un sólo hogar, por lo que al mismo tiempo casi un 30% de ellas trabaja en más de una vivienda.            

En relación a la cantidad de horas que trabajan semanalmente las empleadas domésticas, un 54,1% son ocupadas "plenas", es decir que trabajan entre 35 y 45 horas semanales, o están conformes con la cantidad de horas que trabajan. Al mismo tiempo, cerca de un 43,7% se encuentra sub o sobre ocupada: un 10,5% trabaja más de 45 horas por semana, y un 33,2% trabaja menos de 35 horas semanales por causas involuntarias y está dispuesta a trabajar más horas.   
          
<p style="color:#FE1764">__Intensidad del trabajo__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% 
  mutate(Intensidad = case_when(INTENSI == 1 ~ "Subocupadas por insuficiencia horaria",
                                INTENSI == 2 ~ "Ocupadas plenas",
                                INTENSI == 3 ~ "Sobreocupadas",
                                INTENSI == 4 ~ "Ocupada que no trabajó en la semana")) %>% 
  group_by(Intensidad) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  filter(Intensidad != "Ocupada que no trabajó en la semana") %>% 
  select(Intensidad, Cantidad, Porcentaje) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

_Nota: La estimación correspondiente a aquellas que no trabajaron en la semana de referencia de la encuesta no cuenta con suficientes casos muestrales como para garantizar significatividad del dato, por lo que se ha retirado del cuadro la categoría._ 

<p style="color:#FE1764">__Cantidad de hogares en los que trabajan COMPLETAR TITULO__</p>
```{r echo=FALSE, message=FALSE, warning=FALSE}
serv.dom %>% 
  filter(PP3E_TOT > 0, # Horas trabajadas positivas
         PP3E_TOT != 999) %>% 
  mutate(cantidad_hogares = case_when(PP04B2 == 1 ~ "1",
                                      PP04B2 == 2 ~ "2",
                                      PP04B2 >= 3 ~ "3 o más")) %>% 
  group_by(cantidad_hogares) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA),
            hs_ocup_princ = formato_porc(weighted.mean(PP3E_TOT, PONDERA)),
            hs_totales = formato_porc(weighted.mean(PP3E_TOT + PP3F_TOT, PONDERA))) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100),
         Cantidad = formato_cantidad(Cantidad)) %>% 
  select("Cantidad de hogares en que trabaja" = cantidad_hogares,
         Cantidad, Porcentaje, 
         "hs/sem en ocup. princ." = hs_ocup_princ, 
         "hs/sem con ocup. secund." = hs_totales) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

### Derechos laborales

```{r message=FALSE, warning=FALSE, include=FALSE}
# Total de asalariades. Empleo sin descuento jubilatorio
base_individual %>% 
  filter(ESTADO == 1,
         CAT_OCUP==3) %>% 
  summarise("Tasa de no registro" = formato_porc(sum(PONDERA[PP07H==2])/sum(PONDERA)*100))

# Total de asalariades. Empleo sin descuento jubilatorio por sexo
base_individual %>% 
  filter(ESTADO==1,
         CAT_OCUP==3) %>% 
  group_by(Sexo) %>% 
  summarise("Tasa de no registro" = formato_porc(sum(PONDERA[PP07H==2])/sum(PONDERA)*100))
```

Dentro del conjunto de asalariades, un 34,5% no se encuentra registrade en la seguridad social (tasa que asciende al 36,1% cuando hablamos de las asalariadas mujeres), también puede observarse que el fenómeno se agrava ampliamente entre las trabajadoras domésticas: un 73,5% de ellas no percibe descuento jubilatorio.          
                  
En este apartado se presentan indicadores referidos a los derechos laborales de les asalariades, y el acceso a los mismos por parte de las trabajadoras del sector de servicio doméstico. Cabe destacar que los resultados se encuentran altamente correlacionados con la falta de acceso al descuento jubilatorio que caracteriza a dicha población.   
Un 69,2% de estas trabajadoras no cuenta con vacaciones pagas, un 68,1% no percibe aguinaldos, un 72,2% no percibe el pago en caso de enfermedad, y un 72,6% no cuenta con cobertura de salud mediante Obra Social.        
                     

```{r message=FALSE, warning=FALSE, include=FALSE}
tabla1 <- serv.dom %>% 
  group_by(Descuento_jubilatorio) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select(Descuento_jubilatorio, Porcentaje) %>% 
  pivot_wider(names_from = Descuento_jubilatorio, values_from = Porcentaje) %>% 
  mutate(Indicador = "¿Tiene descuento jubilatorio?")

tabla2 <- serv.dom %>% 
  group_by(Vacaciones_pagas) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select(Vacaciones_pagas, Porcentaje) %>% 
  pivot_wider(names_from = Vacaciones_pagas, values_from = Porcentaje) %>% 
  mutate(Indicador = "¿Tiene vacaciones pagas?")

tabla3 <- serv.dom %>% 
  group_by(Aguinaldo) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select(Aguinaldo, Porcentaje) %>% 
  pivot_wider(names_from = Aguinaldo, values_from = Porcentaje) %>% 
  mutate(Indicador = "¿Tiene aguinaldo?")

tabla4 <- serv.dom %>% 
  group_by(Dias_enfermedad) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select(Dias_enfermedad, Porcentaje) %>% 
  pivot_wider(names_from = Dias_enfermedad, values_from = Porcentaje) %>% 
  mutate(Indicador = "¿Tiene días pagos por enfermedad?")

tabla5 <- serv.dom %>% 
  group_by(Obra_social) %>% 
  summarise(Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = formato_porc(Cantidad/sum(Cantidad)*100)) %>% 
  select(Obra_social, Porcentaje) %>% 
  pivot_wider(names_from = Obra_social, values_from = Porcentaje) %>% 
  mutate(Indicador = "¿Tiene obra social?")
```

<p style="color:#FE1764">__En ese trabajo tiene...__</p>     

```{r echo=FALSE, message=FALSE, warning=FALSE}
bind_rows(tabla1, tabla2, tabla3, tabla4, tabla5) %>% 
  select(Indicador, Sí, No) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

```{r message=FALSE, warning=FALSE, include=FALSE}
rm(tabla1, tabla2, tabla3, tabla4, tabla5)
```
  
### Ingresos

Respecto de la percepción de ingresos, teniendo en cuenta a la ocupación principal (el hogar para el que más horas trabaja), el ingreso de estas trabajadoras promedia $7.243, mientras que la mitad percibe menos de $6.000 por mes. Si se tienen en cuenta también los ingresos de las ocupaciones secundarias (aquellos otros hogares para los que se trabaja u otras ocupaciones secundarias), los ingresos promedian $8.425, y la mitad de ellas no alcanza los $8.000 mensuales.                  

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Ingresos mensuales, de la ocupación principal
tabla1 <- serv.dom %>% 
  filter(PP3E_TOT > 0, # Horas trabajadas positivas
         PP3E_TOT != 999) %>% 
  summarise("Ingreso promedio" = formato_pesos(weighted.mean(P21, PONDIIO)),
            "50% cobra menos de" = formato_pesos(spatstat::weighted.median(P21, PONDIIO))) %>% 
  mutate(Ingresos =  "Mensuales, de la ocupación principal")

# Ingresos por hora, de la ocupación principal
tabla2 <- serv.dom %>% 
  filter(PP3E_TOT > 0, # Horas trabajadas positivas
         PP3E_TOT != 999) %>% 
  summarise("Ingreso promedio" = formato_pesos(weighted.mean(P21/(PP3E_TOT * 30 / 7), PONDIIO)),
            "50% cobra menos de" = formato_pesos(spatstat::weighted.median(P21/(PP3E_TOT * 30 / 7), PONDIIO))) %>% 
  mutate(Ingresos =  "Por hora, de la ocupación principal")

# Ingresos mensuales, total de fuente laboral
tabla3 <- serv.dom %>% 
  summarise("Ingreso promedio" = formato_pesos(weighted.mean(P47T - T_VI, PONDII)),
            "50% cobra menos de" = formato_pesos(spatstat::weighted.median(P47T - T_VI, PONDII))) %>% 
  mutate(Ingresos =  "Mensuales, total de fuente laboral")
  
# Ingresos mensuales, totales individuales
tabla4 <- serv.dom %>% 
  summarise("Ingreso promedio" = formato_pesos(weighted.mean(P47T, PONDII)),
            "50% cobra menos de" = formato_pesos(spatstat::weighted.median(P47T, PONDII))) %>% 
  mutate(Ingresos =  "Mensuales, ingreso total individual")

# Ingresos mensuales, totales familiares
tabla5 <- serv.dom %>% 
  summarise("Ingreso promedio" = formato_pesos(weighted.mean(ITF, PONDIH)),
            "50% cobra menos de" = formato_pesos(spatstat::weighted.median(ITF, PONDIH))) %>% 
  mutate(Ingresos =  "Mensuales, ingreso total familiar")

# Ingresos mensuales, per capita familiar
tabla6 <- serv.dom %>% 
  summarise("Ingreso promedio" = formato_pesos(weighted.mean(IPCF, PONDIH)),
            "50% cobra menos de" = formato_pesos(spatstat::weighted.median(IPCF, PONDIH))) %>% 
  mutate(Ingresos =  "Mensuales, ingreso per cápita familiar")
```

<p style="color:#FE1764">__TITULO__</p> 
```{r echo=FALSE, message=FALSE, warning=FALSE}
bind_rows(tabla1, tabla2, tabla3, tabla4, tabla5, tabla6) %>% 
  select(Ingresos, everything()) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

```{r message=FALSE, warning=FALSE, include=FALSE}
rm(tabla1, tabla2, tabla3, tabla4, tabla5, tabla6)
```
          
<p style="color:#FE1764">__TITULO__</p> 
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Ingresos mensuales y por hora, de la ocupación principal
serv.dom %>% 
  filter(PP3E_TOT > 0, # Horas trabajadas positivas
         PP3E_TOT != 999) %>% 
  group_by(Descuento_jubilatorio) %>% 
  summarise(Ingresos = formato_pesos(weighted.mean(P21, PONDIIO)),
            Ingresos_hs = formato_pesos(weighted.mean(P21/(PP3E_TOT * 30 / 7), PONDIIO)),
            hs_ocup_princ = formato_porc(weighted.mean(PP3E_TOT, PONDERA))) %>% 
  arrange(Ingresos) %>% 
  select("¿Tiene descuento jubilatorio?" = Descuento_jubilatorio,
         "Ingreso mensual promedio" = Ingresos,
         "Ingreso por hora promedio" = Ingresos_hs,
         "hs/sem en ocup. princ." = hs_ocup_princ) %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764")
```

<p style="color:#FE1764">__TITULO?__</p> 
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Deciles de Ingreso de la Ocup Principal
serv.dom %>% 
  mutate(DECOCUR = as.integer(DECOCUR)) %>% 
  filter(DECOCUR %in% c(1:10)) %>% 
  group_by(DECOCUR) %>% 
  summarise(Cantidad = sum(PONDIH)) %>% 
  ggplot(., aes(x = DECOCUR, y = Cantidad)) +
  geom_col(fill = "#FE1764") +
  scale_x_continuous(breaks = 1:10) +
  labs(title = "Trabajadoras de servicio doméstico según deciles",
       subtitle = paste0("Deciles de ingreso de la ocupación principal. ", date),
       caption = "Fuente: Natsumi Shokida en base a EPH-INDEC") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_blank())
```

### Hogares de las trabajadoras de servicio doméstico

<p style="color:#FE1764">__TITULO?__</p> 
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Deciles de Ingreso Per Capita Familiar
serv.dom %>% 
  mutate(DECCFR = as.integer(DECCFR)) %>% 
  filter(DECCFR %in% c(1:10)) %>% 
  group_by(DECCFR) %>% 
  summarise(Cantidad = sum(PONDIH)) %>% 
  ggplot(., aes(x = DECCFR, y = Cantidad)) +
  geom_col(fill = "#FE1764") +
  scale_x_continuous(breaks = 1:10) +
  labs(title = "Trabajadoras de servicio doméstico según deciles",
       subtitle = paste0("Deciles de ingreso per cápita familiar. ", date),
       caption = "Fuente: Natsumi Shokida en base a EPH-INDEC") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_blank())
```

```{r message=FALSE, warning=FALSE, include=FALSE}
# Son el ingreso principal del hogar?
ingresos_principales <- base_individual %>%
  group_by(CODUSU, NRO_HOGAR) %>% 
  mutate(es_principal = case_when(P47T == max(P47T) ~  "Sí",
                                  TRUE ~ "No")) %>% 
  select(CODUSU, NRO_HOGAR, COMPONENTE, es_principal)

serv.dom <- left_join(serv.dom, ingresos_principales, by = c("CODUSU", "NRO_HOGAR", "COMPONENTE"))

serv.dom %>% 
  group_by(es_principal) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = Cantidad/sum(Cantidad)*100)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
# Realización de las tareas de la casa
serv.dom <- serv.dom %>% 
  left_join(., base_hogar %>% 
              select(CODUSU, NRO_HOGAR, VII1_1, VII1_2), by = c("CODUSU", "NRO_HOGAR")) %>% 
  mutate(realiza = case_when(VII1_1 == COMPONENTE | VII1_2 == COMPONENTE ~ "Sí",
                                    TRUE ~ "No")) 

serv.dom %>% 
  group_by(realiza) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  mutate(Porcentaje = Cantidad/sum(Cantidad)*100)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
matriz <- serv.dom %>% 
  group_by(es_principal, realiza) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA)) %>% 
  ungroup() %>% 
  mutate(Porcentaje = Cantidad/sum(Cantidad)*100) %>% 
  select(es_principal, realiza, Porcentaje) %>% 
  arrange(-Porcentaje)
```

<p style="color:#FE1764">__TITULO__</p> 

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(matriz, aes(es_principal, realiza, fill = Porcentaje)) +
  geom_tile() +
  geom_text(aes(label = str_c(round(Porcentaje, 1), "%")), size = 8) +
  scale_fill_gradient(low = "white", high = "#FE1764") +
  scale_x_discrete(position = "top") +
  geom_tile(color = "black", fill = "black", alpha = 0) +
  theme_minimal() +
  theme() +
  labs(x = '¿Percibe el ingreso principal del hogar?',
       y = '¿Realiza las tareas domésticas en su hogar?',
       title = paste0("Trabajadoras de servicio doméstico. ", date),
       caption = "Fuente: Natsumi Shokida en base a EPH-INDEC") +
  guides(fill = FALSE)
```

### Comparación entre ramas de la ocupación         

Es útil contextualizar muchos de los indicadores presentados realizando una comparación con otras actividades que agrupan a les distintes trabajadores, por lo que en esta sección se presentan tablas que permiten realizar este ejercicio. En todos estos casos se consideró la rama de actividad de la ocupación principal de estas personas.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Implemento la función que construye la rama EPH con nombres descriptivos, directo desde la PP04B_COD
base_individual <- base_individual %>%
  mutate(rama.nombre = entra.cuchillo.salen.las.ramas(PP04B_COD))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
asalariades <- base_individual %>%
  filter(ESTADO == 1,
         CAT_OCUP == 3)

asalariades %>% 
  group_by(rama.nombre) %>% 
  summarise(n = n(),
            Cantidad = sum(PONDERA))

table(asalariades$rama.nombre, asalariades$PP04B1, exclude = NULL)
# Hay casos de Servicio domestico en la rama pero que no tienen marcada la variable que las identifica como prestadoras de servicio doméstico en hogares, son 21 casos muestrales

prueba <- asalariades %>% 
  filter(rama.nombre == "Servicio domestico", 
         PP04B1 == 2)

table(prueba$PP04B_COD, exclude = NULL)
table(prueba$PP04B2, exclude = NULL)
# Los 21 casos tienen rama "9700", que en CAES Mercosur es "Actividades de los hogares como empleadores de personal doméstico", la misma rama que el resto, pero responden trabajar en "0 casas" y por eso no se tienen en cuenta hasta ahora, en la base serv.dom.
```

<p style="color:#FE1764">__Asalariades - Indicadores por rama__</p> 
```{r echo=FALSE, message=FALSE, warning=FALSE}
asal.ramas <- asalariades %>% 
  mutate(total = sum(PONDERA),
         total_mujeres = sum(PONDERA[Sexo == "Mujeres"]),
         total_varones = sum(PONDERA[Sexo == "Varones"])) %>% 
  group_by("Rama" = rama.nombre) %>% 
  summarise(Cantidad = formato_cantidad(sum(PONDERA)),
            Proporcion = round(sum(PONDERA)/unique(total)*100, 1),
            "Tasa de feminizacion" = round(sum(PONDERA[Sexo == "Mujeres"])/sum(PONDERA)*100, 1),
            "Proporción en mujeres" = round(sum(PONDERA[Sexo == "Mujeres"])/unique(total_mujeres)*100, 1),
            "Proporción en varones" = round(sum(PONDERA[Sexo == "Varones"])/unique(total_varones)*100, 1),
            "Tasa de no registro" = round(sum(PONDERA[PP07H == 2])/sum(PONDERA)*100, 1),
            "Ingreso mensual promedio" = formato_pesos(weighted.mean(P21, PONDIIO))) 

asal.ramas2 <- asalariades %>% 
  filter(PP3E_TOT > 0, # Horas trabajadas positivas
         PP3E_TOT != 999) %>% 
  group_by("Rama" = rama.nombre) %>% 
  summarise("Ingreso horario promedio" = formato_pesos(weighted.mean(P21/(PP3E_TOT * 30 / 7), PONDIIO)))

asal.ramas <- asal.ramas %>% 
  left_join(., asal.ramas2, by = "Rama") %>% 
  arrange(-Proporcion)

asal.ramas %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764") %>% 
  row_spec(which(grepl("Servicio domestico", asal.ramas$Rama)), 
           bold = T, color = "white", background = "#00BDD6")
```

<p style="color:#FE1764">__Ocupades - Indicadores por rama__</p> 
```{r echo=FALSE, message=FALSE, warning=FALSE}
ocup.ramas <- base_individual %>%
  filter(ESTADO == 1) %>% 
  mutate(total = sum(PONDERA),
         total_mujeres = sum(PONDERA[Sexo == "Mujeres"]),
         total_varones = sum(PONDERA[Sexo == "Varones"])) %>% 
  group_by("Rama" = rama.nombre) %>% 
  summarise(Cantidad = formato_cantidad(sum(PONDERA)),
            Proporcion = round(sum(PONDERA)/unique(total)*100, 1),
            "Tasa de feminizacion" = round(sum(PONDERA[Sexo == "Mujeres"])/sum(PONDERA)*100, 1),
            "Proporción en mujeres" = round(sum(PONDERA[Sexo == "Mujeres"])/unique(total_mujeres)*100, 1),
            "Proporción en varones" = round(sum(PONDERA[Sexo == "Varones"])/unique(total_varones)*100, 1),
            "Tasa de no registro" = round(sum(PONDERA[PP07H == 2])/sum(PONDERA)*100, 1),
            "Ingreso promedio" = formato_pesos(weighted.mean(P21, PONDIIO))) 

ocup.ramas2 <- base_individual %>%
  filter(ESTADO == 1) %>% 
  filter(PP3E_TOT > 0, # Horas trabajadas positivas
         PP3E_TOT != 999) %>% 
  group_by("Rama" = rama.nombre) %>% 
  summarise("Ingreso horario promedio" = formato_pesos(weighted.mean(P21/(PP3E_TOT * 30 / 7), PONDIIO)))

ocup.ramas <- ocup.ramas %>% 
  left_join(., ocup.ramas2, by = "Rama") %>% 
  arrange(-Proporcion)

ocup.ramas %>% 
  kable(align = "r") %>% 
  kable_styling(c("striped", "hover", "condensed", "responsive"),
                fixed_thead = T) %>% 
  row_spec(0, bold = T, color = "white", background = "#FE1764") %>% 
  row_spec(which(grepl("Servicio domestico", ocup.ramas$Rama)), 
           bold = T, color = "white", background = "#00BDD6")
```






